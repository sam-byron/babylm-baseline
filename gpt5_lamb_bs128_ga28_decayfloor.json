{
  "_comment": "LAMB bs128Ã—ga28 with lower LR floor to extend late-phase decay; stability-focused variant",
  "_source": "Derived from bs128_ga28; only schedule floor & warmup adjustments for plateau relief",

  "block_size": 128,
  "num_epochs": 225,

  "batch_size": 128,
  "grad_accum": 28,
  "_world_size_hint": 3,
  "_effective_sequences_per_update": 10752,
  "_effective_tokens_per_update": 1376256,

  "vocab_size": 16384,
  "dataset_split": "train",
  "tokenizer_path": "./data/pretrain/wordpiece_vocab.json",

  "optimizer": "lamb",
  "learning_rate": 0.006,
  "lr_scale_alpha": 0.5,
  "peak_lr_cap": 0.010,
  "min_lr": 5e-6,
  "warmup_steps_proportion": 0.015,
  "optimizer_eps": 1e-6,
  "weight_decay": 0.01,
  "head_weight_decay": 0.1,
  "max_grad_norm": 0.8,

  "attention_probs_dropout_prob": 0.1,
  "hidden_dropout_prob": 0.1,

  "hidden_size": 768,
  "intermediate_size": 2048,
  "num_attention_heads": 12,
  "num_hidden_layers": 12,
  "position_bucket_size": 32,
  "layer_norm_eps": 1e-5,
  "share_layer_weights": false,

  "masking_strategy": "whole_word",
  "mask_p": 0.15,
  "random_p": 0.1,
  "keep_p": 0.1,
  "max_span_length": 5,
  "use_dynamic_masking": true,

  "cache_path": "model_babylm_bert_ltg",
  "chunk_size": 10000,

  "monitoring": {
    "spike_threshold": 0.6,
    "oscillation_threshold": 0.3,
    "window_size": 100
  }
}
